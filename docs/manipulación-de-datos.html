<!DOCTYPE html>
<html lang="es" xml:lang="es">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Clase 2 MANIPULACIÓN DE DATOS | 01-conocer.Rmd</title>
  <meta name="description" content="Clase 2 MANIPULACIÓN DE DATOS | 01-conocer.Rmd" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Clase 2 MANIPULACIÓN DE DATOS | 01-conocer.Rmd" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Clase 2 MANIPULACIÓN DE DATOS | 01-conocer.Rmd" />
  
  
  

<meta name="author" content="Angie Scetta" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="presentación.html"/>
<link rel="next" href="análisis-y-visualización-de-datos.html"/>
<script src="libs/header-attrs-2.7/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Big Data Urbana</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>INTRODUCCIÓN</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#indice"><i class="fa fa-check"></i>Indice</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="presentación.html"><a href="presentación.html"><i class="fa fa-check"></i><b>1</b> PRESENTACIÓN</a>
<ul>
<li class="chapter" data-level="1.1" data-path="presentación.html"><a href="presentación.html#interfaz-gráfica-de-rstudio"><i class="fa fa-check"></i><b>1.1</b> Interfaz Gráfica de RStudio</a></li>
<li class="chapter" data-level="1.2" data-path="presentación.html"><a href="presentación.html#formato-rmarkdown"><i class="fa fa-check"></i><b>1.2</b> Formato RMarkdown</a></li>
<li class="chapter" data-level="1.3" data-path="presentación.html"><a href="presentación.html#nuestro-primer-dataset"><i class="fa fa-check"></i><b>1.3</b> Nuestro primer dataset</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="manipulación-de-datos.html"><a href="manipulación-de-datos.html"><i class="fa fa-check"></i><b>2</b> MANIPULACIÓN DE DATOS</a>
<ul>
<li class="chapter" data-level="2.1" data-path="manipulación-de-datos.html"><a href="manipulación-de-datos.html#filtrar-registros-que-cumplan-condiciones"><i class="fa fa-check"></i><b>2.1</b> Filtrar registros que cumplan condiciones</a></li>
<li class="chapter" data-level="2.2" data-path="manipulación-de-datos.html"><a href="manipulación-de-datos.html#seleccionar-columnas-de-interés"><i class="fa fa-check"></i><b>2.2</b> Seleccionar columnas de interés</a></li>
<li class="chapter" data-level="2.3" data-path="manipulación-de-datos.html"><a href="manipulación-de-datos.html#modificar-o-agregar-columnas"><i class="fa fa-check"></i><b>2.3</b> Modificar o agregar columnas</a></li>
<li class="chapter" data-level="2.4" data-path="manipulación-de-datos.html"><a href="manipulación-de-datos.html#ordenar-registros"><i class="fa fa-check"></i><b>2.4</b> Ordenar registros</a></li>
<li class="chapter" data-level="2.5" data-path="manipulación-de-datos.html"><a href="manipulación-de-datos.html#renombrar-columnas"><i class="fa fa-check"></i><b>2.5</b> Renombrar columnas</a></li>
<li class="chapter" data-level="2.6" data-path="manipulación-de-datos.html"><a href="manipulación-de-datos.html#resumir-y-agrupar-datos"><i class="fa fa-check"></i><b>2.6</b> Resumir y agrupar datos</a></li>
<li class="chapter" data-level="2.7" data-path="manipulación-de-datos.html"><a href="manipulación-de-datos.html#concatenar-funciones"><i class="fa fa-check"></i><b>2.7</b> Concatenar funciones (%&gt;%)</a></li>
<li class="chapter" data-level="2.8" data-path="manipulación-de-datos.html"><a href="manipulación-de-datos.html#transformar-la-estructura-de-los-datos"><i class="fa fa-check"></i><b>2.8</b> Transformar la estructura de los datos</a>
<ul>
<li class="chapter" data-level="2.8.1" data-path="manipulación-de-datos.html"><a href="manipulación-de-datos.html#extender-la-estructura-de-los-datos-spread"><i class="fa fa-check"></i><b>2.8.1</b> Extender la estructura de los datos: spread()</a></li>
<li class="chapter" data-level="2.8.2" data-path="manipulación-de-datos.html"><a href="manipulación-de-datos.html#unificar-los-datos-gather"><i class="fa fa-check"></i><b>2.8.2</b> Unificar los datos: gather()</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="análisis-y-visualización-de-datos.html"><a href="análisis-y-visualización-de-datos.html"><i class="fa fa-check"></i><b>3</b> ANÁLISIS Y VISUALIZACIÓN DE DATOS</a>
<ul>
<li class="chapter" data-level="3.1" data-path="análisis-y-visualización-de-datos.html"><a href="análisis-y-visualización-de-datos.html#distribución-de-una-variable-continua"><i class="fa fa-check"></i><b>3.1</b> Distribución de una variable continua</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="análisis-y-visualización-de-datos.html"><a href="análisis-y-visualización-de-datos.html#histograma"><i class="fa fa-check"></i><b>3.1.1</b> Histograma</a></li>
<li class="chapter" data-level="3.1.2" data-path="análisis-y-visualización-de-datos.html"><a href="análisis-y-visualización-de-datos.html#gráfico-de-densidad"><i class="fa fa-check"></i><b>3.1.2</b> Gráfico de Densidad</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="análisis-y-visualización-de-datos.html"><a href="análisis-y-visualización-de-datos.html#distribución-de-valores-continuos-asociados-a-una-variable-categórica-gráfico-de-cajas"><i class="fa fa-check"></i><b>3.2</b> Distribución de valores continuos asociados a una variable categórica: Gráfico de Cajas</a></li>
<li class="chapter" data-level="3.3" data-path="análisis-y-visualización-de-datos.html"><a href="análisis-y-visualización-de-datos.html#relación-entre-variables-numéricas-gráfico-de-dispersión"><i class="fa fa-check"></i><b>3.3</b> Relación entre variables numéricas: Gráfico de Dispersión</a></li>
<li class="chapter" data-level="3.4" data-path="análisis-y-visualización-de-datos.html"><a href="análisis-y-visualización-de-datos.html#relación-entre-variables-categóricas-gráfico-de-matriz"><i class="fa fa-check"></i><b>3.4</b> Relación entre variables categóricas: Gráfico de Matriz</a></li>
<li class="chapter" data-level="3.5" data-path="análisis-y-visualización-de-datos.html"><a href="análisis-y-visualización-de-datos.html#relación-entre-variable-numérica-y-categórica-gráfico-de-barras"><i class="fa fa-check"></i><b>3.5</b> Relación entre variable numérica y categórica: Gráfico de Barras</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="información-geográfica-y-mapas.html"><a href="información-geográfica-y-mapas.html"><i class="fa fa-check"></i><b>4</b> INFORMACIÓN GEOGRÁFICA Y MAPAS</a>
<ul>
<li class="chapter" data-level="4.1" data-path="información-geográfica-y-mapas.html"><a href="información-geográfica-y-mapas.html#analizar-datos-espaciales"><i class="fa fa-check"></i><b>4.1</b> Analizar datos espaciales</a></li>
<li class="chapter" data-level="4.2" data-path="información-geográfica-y-mapas.html"><a href="información-geográfica-y-mapas.html#cruzar-datos-tradicionales-y-espaciales"><i class="fa fa-check"></i><b>4.2</b> Cruzar datos tradicionales y espaciales</a></li>
<li class="chapter" data-level="4.3" data-path="información-geográfica-y-mapas.html"><a href="información-geográfica-y-mapas.html#cruzar-datos-espaciales"><i class="fa fa-check"></i><b>4.3</b> Cruzar datos espaciales</a></li>
<li class="chapter" data-level="4.4" data-path="información-geográfica-y-mapas.html"><a href="información-geográfica-y-mapas.html#agregar-mapa-base"><i class="fa fa-check"></i><b>4.4</b> Agregar mapa base</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Publicado con bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">01-conocer.Rmd</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="manipulación-de-datos" class="section level1" number="2">
<h1><span class="header-section-number">Clase 2</span> MANIPULACIÓN DE DATOS</h1>
<p>Ahora que ya sabemos abrir un dataset y conocer que información tiene, vamos a aprender a manipular, limpiar, normalizar y transformar los datos, o lo que se conoce como <em>data wrangling</em>. Para esto vamos a trabajar con uno de los paquetes más usados y más útiles de R que se llama <code>tidyverse</code>.</p>
<p>Pero, <strong>¿Qué es un paquete?</strong></p>
<p>Cuando instalamos R ya viene con múltiples funciones básicas para manipular datos, sin embargo el potencial de la herramienta surge con la posibilidad de incorporar constantemente nuevas funciones que nos permitan realizar nuevas tareas o mejorar el resultado de las ya existentes.</p>
<p>Estos grupos de funciones son a los que llamamos paquetes o packages y para poder utilizarlos es necesario <strong>instalarlos por única vez en la computadora</strong>, y luego <strong>activarlos cada vez que vayamos a usarlos</strong>.</p>
<p>Comencemos instalándolo. Esto podemos hacerlo manualmente en Tools/Install packages:</p>
<p><img src="images/005.jpg" /></p>
<p>O directamente escribiendo <code>install.packages()</code> adentro de un chunk:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="manipulación-de-datos.html#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages(&quot;tidyverse&quot;)</span></span></code></pre></div>
<p>Una vez que instalamos el paquete, no vamos a tener que volver a hacerlo. Solamente vamos a tener que “activarlo” cada vez que queramos usarlo. Esta activación se hace con <code>library()</code> así:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="manipulación-de-datos.html#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<p>Ahora volvamos a cargar nuestro dataset (el mismo de la clase anterior):</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="manipulación-de-datos.html#cb22-1" aria-hidden="true" tabindex="-1"></a>datos_amba <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/amba_properati.csv&quot;</span>)</span></code></pre></div>
<p>A continuación veremos como el paquete <code>tidyverse</code> nos va a permitir manipular nuestros datos a partir de las funciones: <strong>filtrar</strong>, <strong>modificar</strong>, <strong>seleccionar</strong>, <strong>ordenar</strong>, <strong>renombrar</strong>, <strong>resumir</strong> y <strong>agrupar</strong>.</p>
<p>Aprender a utilizar todas estas funciones es muy importante ya que la <strong>comprensión, transformación y limpieza de los datos</strong> es la etapa que más tiempo nos llevará a la hora de encarar cualquier proyecto de Ciencia de Datos.</p>
<div id="filtrar-registros-que-cumplan-condiciones" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Filtrar registros que cumplan condiciones</h2>
<p>Como su nombre lo indica, esta función hace referencia a realizar un filtro determinado sobre los registros/filas de toda la base de datos, es decir, quedarnos solo con las filas que cumplan cierta condición establecida. Gráficamente se vería como algo así:</p>
<p><img src="images/tidyverse_filtrar.jpg" /></p>
<p>Esto nos será muy útil si por algún motivo queremos dejar de lado registros y utilizar solo una parte de la base. Por ejemplo, en el caso de nuestro dataset, que ya vimos que incluye datos de AMBA y CABA, podríamos filtrar la data y quedarnos solo con los registros ubicados en CABA:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="manipulación-de-datos.html#cb23-1" aria-hidden="true" tabindex="-1"></a>filtro <span class="ot">&lt;-</span> <span class="fu">filter</span>(datos_amba, provincia<span class="sc">==</span><span class="st">&quot;CABA&quot;</span>)</span>
<span id="cb23-2"><a href="manipulación-de-datos.html#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="manipulación-de-datos.html#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(filtro)</span></code></pre></div>
<pre><code>##   created_on provincia   partido rooms surface_total surface_covered price currency
## 1     202006      CABA  Comuna 7     1            40              37 22500      ARS
## 2     202006      CABA Comuna 13     1            30              30 18000      ARS
## 3     202006      CABA Comuna 13     1            31              29 17900      ARS
## 4     202006      CABA  Comuna 1     1            35              35 42000      ARS
## 5     202006      CABA Comuna 13     2            60              50 32000      ARS
## 6     202006      CABA Comuna 13     2            53              44 26000      ARS
##                                                             title property_type
## 1                                           Departamento - Flores  Departamento
## 2           Retasado! Monoambiente en Nuñez, excelente ubicación!  Departamento
## 3                                         Departamento - Belgrano  Departamento
## 4                Monoambiente con cochera. Zencity. Puerto Madero  Departamento
## 5 Depto 2AMB c/ Suite y Toilette  - Deheza 1600 - Incluye Cochera  Departamento
## 6       Unico 2 ambientes A Estrenar! Posesion inmediata! - Nuñez  Departamento
##   operation_type       lat       lon
## 1       Alquiler -34.61917 -58.46222
## 2       Alquiler -34.55460 -58.46652
## 3       Alquiler -34.56318 -58.46461
## 4       Alquiler -34.61836 -58.36090
## 5       Alquiler -34.53795 -58.46671
## 6       Alquiler -34.54756 -58.47037</code></pre>
<p>O los del mes de Julio 2020:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="manipulación-de-datos.html#cb25-1" aria-hidden="true" tabindex="-1"></a>filtro <span class="ot">&lt;-</span> <span class="fu">filter</span>(datos_amba, created_on<span class="sc">==</span><span class="dv">202007</span>)</span>
<span id="cb25-2"><a href="manipulación-de-datos.html#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="manipulación-de-datos.html#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(filtro)</span></code></pre></div>
<pre><code>##   created_on provincia   partido rooms surface_total surface_covered price currency
## 1     202007       GBA     Tigre     2           108              69 20000      ARS
## 2     202007       GBA     Tigre     2            57              45 27500      ARS
## 3     202007      CABA Comuna 14     1            45              40 23000      ARS
## 4     202007      CABA Comuna 14     2            48              48 30000      ARS
## 5     202007      CABA Comuna 14     2            42              37 26000      ARS
## 6     202007      CABA Comuna 15     2            41              38 21000      ARS
##                                                              title property_type
## 1 DEPARTAMENTO EN ALQUILER EN NORDELTA 2 AMB CON TERRAZA Y JACUZZI  Departamento
## 2        2 ambientes con cochera y baulera - Vista al Lago Central  Departamento
## 3                  Departamento en Alquiler con Balcón y Amenities  Departamento
## 4   Botánico - 2 ambientes amueblado con vista a Boulevard Cerviño  Departamento
## 5                                           Departamento - Palermo  Departamento
## 6               Departamento de 2 ambientes en Alquiler en Palermo  Departamento
##   operation_type       lat       lon
## 1       Alquiler -34.39437 -58.64925
## 2       Alquiler -34.40910 -58.63129
## 3       Alquiler -34.59274 -58.42749
## 4       Alquiler -34.57914 -58.41289
## 5       Alquiler -34.59571 -58.41587
## 6       Alquiler -34.59856 -58.43026</code></pre>
<p>Nótese que para filtrar bajo la condición de “igual” utilicé “==”, pero también podría haber utilizado otras condiciones como:</p>
<ul>
<li><strong>A==B</strong> -&gt; A igual a B</li>
<li><strong>A!=B</strong> -&gt; A diferente a B</li>
<li><strong>A&lt;B</strong> -&gt; A menor a B</li>
<li><strong>A&lt;=B</strong> -&gt; A menor o igual a B</li>
<li><strong>A&gt;B</strong> -&gt; A mayor a B</li>
<li><strong>A&gt;=B</strong> -&gt; A mayor o igual a B</li>
<li><strong>is.na(A)</strong> -&gt; A tiene valor nulo (NA)</li>
<li><strong>!is.na(A)</strong>-&gt; A no tiene valor nulo (NA)</li>
<li><strong>A%in%B</strong> -&gt; A incluye el valor B</li>
<li><strong>!(A%in%B)</strong>-&gt; A no incluye el valor de B</li>
</ul>
<p>Entonces, por ejemplo si quiero quedarme solo con las propiedades que tienen una superficie cubierta mayor o igual a 75m2 debería escribirlo así:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="manipulación-de-datos.html#cb27-1" aria-hidden="true" tabindex="-1"></a>filtro <span class="ot">&lt;-</span> <span class="fu">filter</span>(datos_amba, surface_covered<span class="sc">&gt;=</span><span class="dv">75</span>)</span>
<span id="cb27-2"><a href="manipulación-de-datos.html#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="manipulación-de-datos.html#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(filtro)</span></code></pre></div>
<pre><code>##   created_on provincia   partido rooms surface_total surface_covered  price currency
## 1     202006       GBA Ituzaingó     3            75              75  19000      ARS
## 2     202006       GBA     Tigre     3            95              80  42000      ARS
## 3     202006       GBA     Tigre     3            98              90  42000      ARS
## 4     202006      CABA Comuna 13     3           109              94  90000      ARS
## 5     202006      CABA Comuna 14     3           152             152 240000      ARS
## 6     202006      CABA Comuna 14     3            90              85  80000      ARS
##                                                                                              title
## 1                                            Americana a 6 cuadras de la estacion de S.A. de Padua
## 2                                   3 AMBIENTES EN EDIFICIO MIRADORES DE LA BAHIA CON COCHERA FIJA
## 3 ¡EN EXCLUSIVA! Departamento en alquiler de 3 ambientes Miradores de La Bahía, Bahía de Nordelta.
## 4                                                  Alquiler Depto 3 Amb a Estrenar Nuñez C/Cochera
## 5           ALQUILER en TORRES DE GELLY 152 m2 con 2 dorm dep y 1 coch ALTO vista Rio  SIN muebles
## 6                                    ALQUILER 3 AMB CON DEPENDENCIA! - Y COCHERA TORRE AMENITIES!!
##   property_type operation_type       lat       lon
## 1          Casa       Alquiler -34.65957 -58.69712
## 2  Departamento       Alquiler -34.39642 -58.64665
## 3  Departamento       Alquiler -34.39512 -58.64665
## 4  Departamento       Alquiler -34.54521 -58.46286
## 5  Departamento       Alquiler -34.57760 -58.40499
## 6  Departamento       Alquiler -34.59353 -58.41462</code></pre>
<p>O si quiero eliminar los registros que corresponden a departamentos debería hacer el siguiente chunk:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="manipulación-de-datos.html#cb29-1" aria-hidden="true" tabindex="-1"></a>filtro <span class="ot">&lt;-</span> <span class="fu">filter</span>(datos_amba, property_type<span class="sc">!=</span><span class="st">&quot;Departamento&quot;</span>)</span>
<span id="cb29-2"><a href="manipulación-de-datos.html#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="manipulación-de-datos.html#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(filtro)</span></code></pre></div>
<pre><code>##   created_on provincia            partido rooms surface_total surface_covered price
## 1     202006       GBA         La Matanza     2            24              24 12000
## 2     202006       GBA General San Martín     2            40              40 15000
## 3     202006       GBA          Ituzaingó     3            75              75 19000
## 4     202006      CABA          Comuna 14     4           125             105 85000
## 5     202006       GBA              Merlo     4           180             140 27000
## 6     202006       GBA              Pilar     4           267             267 50000
##   currency                                                 title property_type
## 1      ARS                                PH - Lomas Del Mirador            PH
## 2      ARS                                        PH - Chilavert            PH
## 3      ARS Americana a 6 cuadras de la estacion de S.A. de Padua          Casa
## 4      ARS              PH en alquiler 4 ambientes - Las Cañitas            PH
## 5      ARS               Casa en Padua 3 dormitorios en alquiler          Casa
## 6      ARS              Casa en venta o alquiler en La Peregrina          Casa
##   operation_type       lat       lon
## 1       Alquiler -34.66253 -58.52914
## 2       Alquiler -34.54301 -58.57573
## 3       Alquiler -34.65957 -58.69712
## 4       Alquiler -34.57207 -58.43249
## 5       Alquiler -34.66154 -58.71565
## 6       Alquiler -34.47091 -58.82270</code></pre>
<p>Si queremos filtrar todas las propiedades ubicadas en 3 partidos diferentes como por ejempo La Plata, General San Martín y La Matanza debemos utilizar %in% de la siguiente forma:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="manipulación-de-datos.html#cb31-1" aria-hidden="true" tabindex="-1"></a>filtro <span class="ot">&lt;-</span> <span class="fu">filter</span>(datos_amba, partido <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;La Plata&quot;</span>, <span class="st">&quot;General San Martín&quot;</span>, <span class="st">&quot;La Matanza&quot;</span>))</span>
<span id="cb31-2"><a href="manipulación-de-datos.html#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="manipulación-de-datos.html#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(filtro)</span></code></pre></div>
<pre><code>##   created_on provincia            partido rooms surface_total surface_covered price
## 1     202006       GBA         La Matanza     2            24              24 12000
## 2     202006       GBA General San Martín     2            40              40 15000
## 3     202006       GBA           La Plata     2            50              50 18000
## 4     202006       GBA           La Plata     2            35              35 13500
## 5     202006       GBA General San Martín     2            56              48 14000
## 6     202006       GBA           La Plata     3            40              40 10000
##   currency                                                       title property_type
## 1      ARS                                      PH - Lomas Del Mirador            PH
## 2      ARS                                              PH - Chilavert            PH
## 3      ARS Alquiler, depto de un domitorio frente al parque San Martin  Departamento
## 4      ARS                                     Departamento - La Plata  Departamento
## 5      ARS                     Departamento céntrico - Villa Ballester  Departamento
## 6      ARS                               Departamento - José Hernández  Departamento
##   operation_type       lat       lon
## 1       Alquiler -34.66253 -58.52914
## 2       Alquiler -34.54301 -58.57573
## 3       Alquiler -34.93415 -57.96605
## 4       Alquiler -34.90645 -57.97335
## 5       Alquiler -34.55038 -58.55512
## 6       Alquiler -34.89768 -58.02787</code></pre>
<p>En cambio, si queremos filtrar todas las propiedades que no estén ubicadas en 3 partidos diferentes como por ejempo La Plata, General San Martín y La Matanza debemos utilizar ! + %in% de la siguiente forma:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="manipulación-de-datos.html#cb33-1" aria-hidden="true" tabindex="-1"></a>filtro <span class="ot">&lt;-</span> <span class="fu">filter</span>(datos_amba, <span class="sc">!</span>(partido <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;La Plata&quot;</span>, <span class="st">&quot;General San Martín&quot;</span>, <span class="st">&quot;La Matanza&quot;</span>)))</span>
<span id="cb33-2"><a href="manipulación-de-datos.html#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="manipulación-de-datos.html#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(filtro)</span></code></pre></div>
<pre><code>##   created_on provincia       partido rooms surface_total surface_covered price currency
## 1     202006      CABA      Comuna 7     1            40              37 22500      ARS
## 2     202006      CABA     Comuna 13     1            30              30 18000      ARS
## 3     202006      CABA     Comuna 13     1            31              29 17900      ARS
## 4     202006      CABA      Comuna 1     1            35              35 42000      ARS
## 5     202006       GBA Vicente López     1            36              27 19000      ARS
## 6     202006      CABA     Comuna 13     2            60              50 32000      ARS
##                                                                           title
## 1                                                         Departamento - Flores
## 2                         Retasado! Monoambiente en Nuñez, excelente ubicación!
## 3                                                       Departamento - Belgrano
## 4                              Monoambiente con cochera. Zencity. Puerto Madero
## 5 Alquiler TORRE dpto de 1o2 ambientes - excelente luz y vista cochera optativa
## 6               Depto 2AMB c/ Suite y Toilette  - Deheza 1600 - Incluye Cochera
##   property_type operation_type       lat       lon
## 1  Departamento       Alquiler -34.61917 -58.46222
## 2  Departamento       Alquiler -34.55460 -58.46652
## 3  Departamento       Alquiler -34.56318 -58.46461
## 4  Departamento       Alquiler -34.61836 -58.36090
## 5  Departamento       Alquiler -34.53344 -58.49345
## 6  Departamento       Alquiler -34.53795 -58.46671</code></pre>
<p>Pero esto no es todo, ¿Cómo hago si quiero filtrar por <strong>2 o más condiciones a la vez</strong>?</p>
<p>En este caso debemos utilizar los siguientes operadores lógicos:</p>
<ul>
<li>condición 1 <strong>&amp;</strong> condición 2 -&gt; se cumplen ambas condiciones a la vez</li>
<li>condición 1 <strong>|</strong> condición 2 -&gt; se cumple una u otra de las condiciones</li>
<li>condición 1 <strong>&amp; !</strong> condición 2 -&gt; se cumple la condición 1 pero no la condición 2</li>
<li><strong>!</strong>condición 1 <strong>&amp;</strong> condición 2 -&gt; no se cumple la condición 1 pero si la condición 2</li>
<li><strong>!</strong>(condición 1 <strong>&amp;</strong> condición 2) -&gt; no se cumple ninguna de las 2 condiciones</li>
</ul>
<p>Por ejemplo, si queremos filtrar todos los registros pertenecientes a la Comuna 5 y a la Comuna 13:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="manipulación-de-datos.html#cb35-1" aria-hidden="true" tabindex="-1"></a>filtro <span class="ot">&lt;-</span> <span class="fu">filter</span>(datos_amba, partido<span class="sc">==</span><span class="st">&quot;Comuna 5&quot;</span> <span class="sc">&amp;</span> partido<span class="sc">==</span><span class="st">&quot;Comuna 13&quot;</span>)</span>
<span id="cb35-2"><a href="manipulación-de-datos.html#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="manipulación-de-datos.html#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(filtro)</span></code></pre></div>
<pre><code>##  [1] created_on      provincia       partido         rooms           surface_total  
##  [6] surface_covered price           currency        title           property_type  
## [11] operation_type  lat             lon            
## &lt;0 rows&gt; (or 0-length row.names)</code></pre>
<p>El resultado es 0 porque un registro no puede pertenecer a ambas comunas al mismo tiempo, sin embargo si queremos filtrar aquellos que pertenecen a una u otra podemos hacerlo así:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="manipulación-de-datos.html#cb37-1" aria-hidden="true" tabindex="-1"></a>filtro <span class="ot">&lt;-</span> <span class="fu">filter</span>(datos_amba, partido<span class="sc">==</span><span class="st">&quot;Comuna 5&quot;</span> <span class="sc">|</span> partido<span class="sc">==</span><span class="st">&quot;Comuna 13&quot;</span>)</span>
<span id="cb37-2"><a href="manipulación-de-datos.html#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="manipulación-de-datos.html#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(filtro)</span></code></pre></div>
<pre><code>##   created_on provincia   partido rooms surface_total surface_covered price currency
## 1     202006      CABA Comuna 13     1            30              30 18000      ARS
## 2     202006      CABA Comuna 13     1            31              29 17900      ARS
## 3     202006      CABA Comuna 13     2            60              50 32000      ARS
## 4     202006      CABA Comuna 13     2            53              44 26000      ARS
## 5     202006      CABA  Comuna 5     2            45              38 20000      ARS
## 6     202006      CABA Comuna 13     2            55              55 45000      ARS
##                                                             title property_type
## 1           Retasado! Monoambiente en Nuñez, excelente ubicación!  Departamento
## 2                                         Departamento - Belgrano  Departamento
## 3 Depto 2AMB c/ Suite y Toilette  - Deheza 1600 - Incluye Cochera  Departamento
## 4       Unico 2 ambientes A Estrenar! Posesion inmediata! - Nuñez  Departamento
## 5              Departamento de 2 ambientes en Alquiler en Almagro  Departamento
## 6                              BLANCO ENCALADA AL 3000 A ESTRENAR  Departamento
##   operation_type       lat       lon
## 1       Alquiler -34.55460 -58.46652
## 2       Alquiler -34.56318 -58.46461
## 3       Alquiler -34.53795 -58.46671
## 4       Alquiler -34.54756 -58.47037
## 5       Alquiler -34.60613 -58.42947
## 6       Alquiler -34.56313 -58.46550</code></pre>
<p>También podemos quedarnos con aquellas propiedades que estén en alquiler y que tengan más de 50m2:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="manipulación-de-datos.html#cb39-1" aria-hidden="true" tabindex="-1"></a>filtro <span class="ot">&lt;-</span> <span class="fu">filter</span>(datos_amba, operation_type<span class="sc">==</span><span class="st">&quot;Alquiler&quot;</span> <span class="sc">&amp;</span> surface_covered<span class="sc">&gt;=</span><span class="dv">50</span>)</span>
<span id="cb39-2"><a href="manipulación-de-datos.html#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="manipulación-de-datos.html#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(filtro)</span></code></pre></div>
<pre><code>##   created_on provincia   partido rooms surface_total surface_covered price currency
## 1     202006      CABA Comuna 13     2            60              50 32000      ARS
## 2     202006      CABA Comuna 13     2            55              55 45000      ARS
## 3     202006       GBA  La Plata     2            50              50 18000      ARS
## 4     202006       GBA Ituzaingó     3            75              75 19000      ARS
## 5     202006       GBA     Tigre     3            95              80 42000      ARS
## 6     202006       GBA     Tigre     3            98              90 42000      ARS
##                                                                                              title
## 1                                  Depto 2AMB c/ Suite y Toilette  - Deheza 1600 - Incluye Cochera
## 2                                                               BLANCO ENCALADA AL 3000 A ESTRENAR
## 3                                      Alquiler, depto de un domitorio frente al parque San Martin
## 4                                            Americana a 6 cuadras de la estacion de S.A. de Padua
## 5                                   3 AMBIENTES EN EDIFICIO MIRADORES DE LA BAHIA CON COCHERA FIJA
## 6 ¡EN EXCLUSIVA! Departamento en alquiler de 3 ambientes Miradores de La Bahía, Bahía de Nordelta.
##   property_type operation_type       lat       lon
## 1  Departamento       Alquiler -34.53795 -58.46671
## 2  Departamento       Alquiler -34.56313 -58.46550
## 3  Departamento       Alquiler -34.93415 -57.96605
## 4          Casa       Alquiler -34.65957 -58.69712
## 5  Departamento       Alquiler -34.39642 -58.64665
## 6  Departamento       Alquiler -34.39512 -58.64665</code></pre>
<p>O con aquellas propiedades que se ubiquen en la Comuna 12, 13 o 14 y que no sean monoambientes:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="manipulación-de-datos.html#cb41-1" aria-hidden="true" tabindex="-1"></a>filtro <span class="ot">&lt;-</span> <span class="fu">filter</span>(datos_amba, partido <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Comuna 14&quot;</span>, <span class="st">&quot;Comuna 13&quot;</span>, <span class="st">&quot;Comuna 12&quot;</span>) <span class="sc">&amp;</span> <span class="sc">!</span> rooms<span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb41-2"><a href="manipulación-de-datos.html#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="manipulación-de-datos.html#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(filtro)</span></code></pre></div>
<pre><code>##   created_on provincia   partido rooms surface_total surface_covered price currency
## 1     202006      CABA Comuna 13     2            60              50 32000      ARS
## 2     202006      CABA Comuna 13     2            53              44 26000      ARS
## 3     202006      CABA Comuna 12     2            42              37 22000      ARS
## 4     202006      CABA Comuna 14     2            43              33 27000      ARS
## 5     202006      CABA Comuna 13     2            55              55 45000      ARS
## 6     202006      CABA Comuna 14     2            48              48 23000      ARS
##                                                             title property_type
## 1 Depto 2AMB c/ Suite y Toilette  - Deheza 1600 - Incluye Cochera  Departamento
## 2       Unico 2 ambientes A Estrenar! Posesion inmediata! - Nuñez  Departamento
## 3                         Depto 2AMB - Av. Balbin 3400 - ALQUILER  Departamento
## 4                     Dos ambientes con Balcón a Demaría y Patio.  Departamento
## 5                              BLANCO ENCALADA AL 3000 A ESTRENAR  Departamento
## 6                                         Departamento - Belgrano  Departamento
##   operation_type       lat       lon
## 1       Alquiler -34.53795 -58.46671
## 2       Alquiler -34.54756 -58.47037
## 3       Alquiler -34.55700 -58.47898
## 4       Alquiler -34.57421 -58.42243
## 5       Alquiler -34.56313 -58.46550
## 6       Alquiler -34.56456 -58.43559</code></pre>
<p>¡Y así se pueden hacer todas las combinaciones de filtros que querramos!</p>
<p>¿Y si en vez de quitar filas queremos quitar columnas? Bueno, aquí tenemos que usar la función de “seleccionar” que veremos a continuación.</p>
</div>
<div id="seleccionar-columnas-de-interés" class="section level2" number="2.2">
<h2><span class="header-section-number">2.2</span> Seleccionar columnas de interés</h2>
<p>La función <code>select()</code> nos permite elegir u ordenar columnas de nuestro dataset. Esto se puede hacer indicando los nombres completos de las columnas, palabras que contienen, o la letra con la que empiezan o terminan.</p>
<p>Graficamente sería algo así:</p>
<p><img src="images/tidyverse_seleccionar.jpg" /></p>
<p>Por ejemplo, de la siguiente forma podríamos quedarnos solo con las columnas created_on, provincia, price y currency:</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="manipulación-de-datos.html#cb43-1" aria-hidden="true" tabindex="-1"></a>seleccion <span class="ot">&lt;-</span> <span class="fu">select</span>(datos_amba, created_on, provincia, price, currency)</span>
<span id="cb43-2"><a href="manipulación-de-datos.html#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="manipulación-de-datos.html#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(seleccion)</span></code></pre></div>
<pre><code>##   created_on provincia price currency
## 1     202006      CABA 22500      ARS
## 2     202006      CABA 18000      ARS
## 3     202006      CABA 17900      ARS
## 4     202006      CABA 42000      ARS
## 5     202006       GBA 19000      ARS
## 6     202006       GBA 12000      ARS</code></pre>
<p>También podríamos elegir que columna/s no queremos tener más en nuestro dataset agregando un “-” antes de su nombre:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="manipulación-de-datos.html#cb45-1" aria-hidden="true" tabindex="-1"></a>seleccion <span class="ot">&lt;-</span> <span class="fu">select</span>(datos_amba, <span class="sc">-</span>title)</span>
<span id="cb45-2"><a href="manipulación-de-datos.html#cb45-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-3"><a href="manipulación-de-datos.html#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(seleccion)</span></code></pre></div>
<pre><code>##   created_on provincia       partido rooms surface_total surface_covered price currency
## 1     202006      CABA      Comuna 7     1            40              37 22500      ARS
## 2     202006      CABA     Comuna 13     1            30              30 18000      ARS
## 3     202006      CABA     Comuna 13     1            31              29 17900      ARS
## 4     202006      CABA      Comuna 1     1            35              35 42000      ARS
## 5     202006       GBA Vicente López     1            36              27 19000      ARS
## 6     202006       GBA    La Matanza     2            24              24 12000      ARS
##   property_type operation_type       lat       lon
## 1  Departamento       Alquiler -34.61917 -58.46222
## 2  Departamento       Alquiler -34.55460 -58.46652
## 3  Departamento       Alquiler -34.56318 -58.46461
## 4  Departamento       Alquiler -34.61836 -58.36090
## 5  Departamento       Alquiler -34.53344 -58.49345
## 6            PH       Alquiler -34.66253 -58.52914</code></pre>
<p>Con “:” podríamos indicar que queremos seleccionar un rango de columnas. Desde price hasta operation_type:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="manipulación-de-datos.html#cb47-1" aria-hidden="true" tabindex="-1"></a>seleccion <span class="ot">&lt;-</span> <span class="fu">select</span>(datos_amba, price<span class="sc">:</span>operation_type)</span>
<span id="cb47-2"><a href="manipulación-de-datos.html#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="manipulación-de-datos.html#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(seleccion)</span></code></pre></div>
<pre><code>##   price currency
## 1 22500      ARS
## 2 18000      ARS
## 3 17900      ARS
## 4 42000      ARS
## 5 19000      ARS
## 6 12000      ARS
##                                                                           title
## 1                                                         Departamento - Flores
## 2                         Retasado! Monoambiente en Nuñez, excelente ubicación!
## 3                                                       Departamento - Belgrano
## 4                              Monoambiente con cochera. Zencity. Puerto Madero
## 5 Alquiler TORRE dpto de 1o2 ambientes - excelente luz y vista cochera optativa
## 6                                                        PH - Lomas Del Mirador
##   property_type operation_type
## 1  Departamento       Alquiler
## 2  Departamento       Alquiler
## 3  Departamento       Alquiler
## 4  Departamento       Alquiler
## 5  Departamento       Alquiler
## 6            PH       Alquiler</code></pre>
<p>O con las que ocupan de la posición 7 a la 10:</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="manipulación-de-datos.html#cb49-1" aria-hidden="true" tabindex="-1"></a>seleccion <span class="ot">&lt;-</span> <span class="fu">select</span>(datos_amba, <span class="dv">7</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb49-2"><a href="manipulación-de-datos.html#cb49-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-3"><a href="manipulación-de-datos.html#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(seleccion)</span></code></pre></div>
<pre><code>##   price currency
## 1 22500      ARS
## 2 18000      ARS
## 3 17900      ARS
## 4 42000      ARS
## 5 19000      ARS
## 6 12000      ARS
##                                                                           title
## 1                                                         Departamento - Flores
## 2                         Retasado! Monoambiente en Nuñez, excelente ubicación!
## 3                                                       Departamento - Belgrano
## 4                              Monoambiente con cochera. Zencity. Puerto Madero
## 5 Alquiler TORRE dpto de 1o2 ambientes - excelente luz y vista cochera optativa
## 6                                                        PH - Lomas Del Mirador
##   property_type
## 1  Departamento
## 2  Departamento
## 3  Departamento
## 4  Departamento
## 5  Departamento
## 6            PH</code></pre>
<p>O agregando un “-” adelante podríamos quedarnos con aquellas que no ocupan de la posición 7 a 10:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="manipulación-de-datos.html#cb51-1" aria-hidden="true" tabindex="-1"></a>seleccion <span class="ot">&lt;-</span> <span class="fu">select</span>(datos_amba, <span class="sc">-</span>(<span class="dv">7</span><span class="sc">:</span><span class="dv">10</span>))</span>
<span id="cb51-2"><a href="manipulación-de-datos.html#cb51-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a href="manipulación-de-datos.html#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(seleccion)</span></code></pre></div>
<pre><code>##   created_on provincia       partido rooms surface_total surface_covered operation_type
## 1     202006      CABA      Comuna 7     1            40              37       Alquiler
## 2     202006      CABA     Comuna 13     1            30              30       Alquiler
## 3     202006      CABA     Comuna 13     1            31              29       Alquiler
## 4     202006      CABA      Comuna 1     1            35              35       Alquiler
## 5     202006       GBA Vicente López     1            36              27       Alquiler
## 6     202006       GBA    La Matanza     2            24              24       Alquiler
##         lat       lon
## 1 -34.61917 -58.46222
## 2 -34.55460 -58.46652
## 3 -34.56318 -58.46461
## 4 -34.61836 -58.36090
## 5 -34.53344 -58.49345
## 6 -34.66253 -58.52914</code></pre>
<p>Otra opción es seleccionar columnas de acuerdo a la primer letra de los nombres. Por ejemplo aquellas que comienzan con la letra “p”:</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="manipulación-de-datos.html#cb53-1" aria-hidden="true" tabindex="-1"></a>seleccion <span class="ot">&lt;-</span> <span class="fu">select</span>(datos_amba, <span class="fu">starts_with</span>(<span class="st">&quot;p&quot;</span>))</span>
<span id="cb53-2"><a href="manipulación-de-datos.html#cb53-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-3"><a href="manipulación-de-datos.html#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(seleccion)</span></code></pre></div>
<pre><code>##   provincia       partido price property_type
## 1      CABA      Comuna 7 22500  Departamento
## 2      CABA     Comuna 13 18000  Departamento
## 3      CABA     Comuna 13 17900  Departamento
## 4      CABA      Comuna 1 42000  Departamento
## 5       GBA Vicente López 19000  Departamento
## 6       GBA    La Matanza 12000            PH</code></pre>
<p>O aquellas que sus nombres terminan con la letra “e”:</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="manipulación-de-datos.html#cb55-1" aria-hidden="true" tabindex="-1"></a>seleccion <span class="ot">&lt;-</span> <span class="fu">select</span>(datos_amba, <span class="fu">ends_with</span>(<span class="st">&quot;e&quot;</span>))</span>
<span id="cb55-2"><a href="manipulación-de-datos.html#cb55-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-3"><a href="manipulación-de-datos.html#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(seleccion)</span></code></pre></div>
<pre><code>##   price                                                                         title
## 1 22500                                                         Departamento - Flores
## 2 18000                         Retasado! Monoambiente en Nuñez, excelente ubicación!
## 3 17900                                                       Departamento - Belgrano
## 4 42000                              Monoambiente con cochera. Zencity. Puerto Madero
## 5 19000 Alquiler TORRE dpto de 1o2 ambientes - excelente luz y vista cochera optativa
## 6 12000                                                        PH - Lomas Del Mirador
##   property_type operation_type
## 1  Departamento       Alquiler
## 2  Departamento       Alquiler
## 3  Departamento       Alquiler
## 4  Departamento       Alquiler
## 5  Departamento       Alquiler
## 6            PH       Alquiler</code></pre>
<p>O que sus nombres contengan la palabra “surface”:</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="manipulación-de-datos.html#cb57-1" aria-hidden="true" tabindex="-1"></a>seleccion <span class="ot">&lt;-</span> <span class="fu">select</span>(datos_amba, <span class="fu">contains</span>(<span class="st">&quot;surface&quot;</span>))</span>
<span id="cb57-2"><a href="manipulación-de-datos.html#cb57-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-3"><a href="manipulación-de-datos.html#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(seleccion)</span></code></pre></div>
<pre><code>##   surface_total surface_covered
## 1            40              37
## 2            30              30
## 3            31              29
## 4            35              35
## 5            36              27
## 6            24              24</code></pre>
</div>
<div id="modificar-o-agregar-columnas" class="section level2" number="2.3">
<h2><span class="header-section-number">2.3</span> Modificar o agregar columnas</h2>
<p>Ahora veamos como mutar nuestro dataset agregando nuevas columnas o cambiando el contenido de las existentes. Gráficamente sería algo así:</p>
<p><img src="images/tidyverse_modificar.jpg" /></p>
<p>Aprovechando que tenemos los datos del precio total (price) y superficie cubierta (surface_covered) de cada una de las propiedades, agreguemos una nueva columna a nuestro dataset que incluya el valor del m2:</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="manipulación-de-datos.html#cb59-1" aria-hidden="true" tabindex="-1"></a>modificar <span class="ot">&lt;-</span> <span class="fu">mutate</span>(datos_amba, <span class="at">price_m2=</span>price<span class="sc">/</span>surface_covered)</span>
<span id="cb59-2"><a href="manipulación-de-datos.html#cb59-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-3"><a href="manipulación-de-datos.html#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(modificar)</span></code></pre></div>
<pre><code>##   created_on provincia       partido rooms surface_total surface_covered price currency
## 1     202006      CABA      Comuna 7     1            40              37 22500      ARS
## 2     202006      CABA     Comuna 13     1            30              30 18000      ARS
## 3     202006      CABA     Comuna 13     1            31              29 17900      ARS
## 4     202006      CABA      Comuna 1     1            35              35 42000      ARS
## 5     202006       GBA Vicente López     1            36              27 19000      ARS
## 6     202006       GBA    La Matanza     2            24              24 12000      ARS
##                                                                           title
## 1                                                         Departamento - Flores
## 2                         Retasado! Monoambiente en Nuñez, excelente ubicación!
## 3                                                       Departamento - Belgrano
## 4                              Monoambiente con cochera. Zencity. Puerto Madero
## 5 Alquiler TORRE dpto de 1o2 ambientes - excelente luz y vista cochera optativa
## 6                                                        PH - Lomas Del Mirador
##   property_type operation_type       lat       lon  price_m2
## 1  Departamento       Alquiler -34.61917 -58.46222  608.1081
## 2  Departamento       Alquiler -34.55460 -58.46652  600.0000
## 3  Departamento       Alquiler -34.56318 -58.46461  617.2414
## 4  Departamento       Alquiler -34.61836 -58.36090 1200.0000
## 5  Departamento       Alquiler -34.53344 -58.49345  703.7037
## 6            PH       Alquiler -34.66253 -58.52914  500.0000</code></pre>
<p>Si queremos redondear el resultado obtenido, principalmente cuando es una división y por default nos pone varios decimales, tenemos que usar <code>round()</code> y asignar la cantidad de decimales deseados, en este caso usaré 2:</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="manipulación-de-datos.html#cb61-1" aria-hidden="true" tabindex="-1"></a>modificar <span class="ot">&lt;-</span> <span class="fu">mutate</span>(datos_amba, <span class="at">price_m2=</span><span class="fu">round</span>(price<span class="sc">/</span>surface_covered, <span class="dv">2</span>))</span>
<span id="cb61-2"><a href="manipulación-de-datos.html#cb61-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-3"><a href="manipulación-de-datos.html#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(modificar)</span></code></pre></div>
<pre><code>##   created_on provincia       partido rooms surface_total surface_covered price currency
## 1     202006      CABA      Comuna 7     1            40              37 22500      ARS
## 2     202006      CABA     Comuna 13     1            30              30 18000      ARS
## 3     202006      CABA     Comuna 13     1            31              29 17900      ARS
## 4     202006      CABA      Comuna 1     1            35              35 42000      ARS
## 5     202006       GBA Vicente López     1            36              27 19000      ARS
## 6     202006       GBA    La Matanza     2            24              24 12000      ARS
##                                                                           title
## 1                                                         Departamento - Flores
## 2                         Retasado! Monoambiente en Nuñez, excelente ubicación!
## 3                                                       Departamento - Belgrano
## 4                              Monoambiente con cochera. Zencity. Puerto Madero
## 5 Alquiler TORRE dpto de 1o2 ambientes - excelente luz y vista cochera optativa
## 6                                                        PH - Lomas Del Mirador
##   property_type operation_type       lat       lon price_m2
## 1  Departamento       Alquiler -34.61917 -58.46222   608.11
## 2  Departamento       Alquiler -34.55460 -58.46652   600.00
## 3  Departamento       Alquiler -34.56318 -58.46461   617.24
## 4  Departamento       Alquiler -34.61836 -58.36090  1200.00
## 5  Departamento       Alquiler -34.53344 -58.49345   703.70
## 6            PH       Alquiler -34.66253 -58.52914   500.00</code></pre>
<p>Como verán, para hacer cálculos entre columnas numéricas podemos utilizar:</p>
<ul>
<li>A / B <strong>A dividido B</strong></li>
<li>A * B <strong>A multiplicado por B</strong></li>
<li>A + B <strong>Suma de A y B</strong></li>
<li>A - B <strong>Resta de A menos B</strong></li>
</ul>
<p>También podríamos agregar una columna que refleje un cálculo entre una columna existente y un valor extra, por ejemplo pasemos la superficie total de m2 a cm2:</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="manipulación-de-datos.html#cb63-1" aria-hidden="true" tabindex="-1"></a>modificar <span class="ot">&lt;-</span> <span class="fu">mutate</span>(datos_amba, <span class="at">surface_total_cm2=</span>surface_total<span class="sc">*</span><span class="dv">10000</span>)</span>
<span id="cb63-2"><a href="manipulación-de-datos.html#cb63-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-3"><a href="manipulación-de-datos.html#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(modificar)</span></code></pre></div>
<pre><code>##   created_on provincia       partido rooms surface_total surface_covered price currency
## 1     202006      CABA      Comuna 7     1            40              37 22500      ARS
## 2     202006      CABA     Comuna 13     1            30              30 18000      ARS
## 3     202006      CABA     Comuna 13     1            31              29 17900      ARS
## 4     202006      CABA      Comuna 1     1            35              35 42000      ARS
## 5     202006       GBA Vicente López     1            36              27 19000      ARS
## 6     202006       GBA    La Matanza     2            24              24 12000      ARS
##                                                                           title
## 1                                                         Departamento - Flores
## 2                         Retasado! Monoambiente en Nuñez, excelente ubicación!
## 3                                                       Departamento - Belgrano
## 4                              Monoambiente con cochera. Zencity. Puerto Madero
## 5 Alquiler TORRE dpto de 1o2 ambientes - excelente luz y vista cochera optativa
## 6                                                        PH - Lomas Del Mirador
##   property_type operation_type       lat       lon surface_total_cm2
## 1  Departamento       Alquiler -34.61917 -58.46222            400000
## 2  Departamento       Alquiler -34.55460 -58.46652            300000
## 3  Departamento       Alquiler -34.56318 -58.46461            310000
## 4  Departamento       Alquiler -34.61836 -58.36090            350000
## 5  Departamento       Alquiler -34.53344 -58.49345            360000
## 6            PH       Alquiler -34.66253 -58.52914            240000</code></pre>
<p>Dejando de lado los cálculos, otra posibilidad que tenemos es separar el contenido de una columna en 2, por ejemplo dividamos en año y mes la data que aparece en created_on. Para esto utilizaremos <code>substr()</code>:</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="manipulación-de-datos.html#cb65-1" aria-hidden="true" tabindex="-1"></a>modificar <span class="ot">&lt;-</span> <span class="fu">mutate</span>(datos_amba,</span>
<span id="cb65-2"><a href="manipulación-de-datos.html#cb65-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">year =</span> <span class="fu">substr</span>(created_on, <span class="dv">1</span>, <span class="dv">4</span>),</span>
<span id="cb65-3"><a href="manipulación-de-datos.html#cb65-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">month =</span> <span class="fu">substr</span>(created_on, <span class="dv">5</span>, <span class="dv">6</span>))</span>
<span id="cb65-4"><a href="manipulación-de-datos.html#cb65-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-5"><a href="manipulación-de-datos.html#cb65-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(modificar)</span></code></pre></div>
<pre><code>##   created_on provincia       partido rooms surface_total surface_covered price currency
## 1     202006      CABA      Comuna 7     1            40              37 22500      ARS
## 2     202006      CABA     Comuna 13     1            30              30 18000      ARS
## 3     202006      CABA     Comuna 13     1            31              29 17900      ARS
## 4     202006      CABA      Comuna 1     1            35              35 42000      ARS
## 5     202006       GBA Vicente López     1            36              27 19000      ARS
## 6     202006       GBA    La Matanza     2            24              24 12000      ARS
##                                                                           title
## 1                                                         Departamento - Flores
## 2                         Retasado! Monoambiente en Nuñez, excelente ubicación!
## 3                                                       Departamento - Belgrano
## 4                              Monoambiente con cochera. Zencity. Puerto Madero
## 5 Alquiler TORRE dpto de 1o2 ambientes - excelente luz y vista cochera optativa
## 6                                                        PH - Lomas Del Mirador
##   property_type operation_type       lat       lon year month
## 1  Departamento       Alquiler -34.61917 -58.46222 2020    06
## 2  Departamento       Alquiler -34.55460 -58.46652 2020    06
## 3  Departamento       Alquiler -34.56318 -58.46461 2020    06
## 4  Departamento       Alquiler -34.61836 -58.36090 2020    06
## 5  Departamento       Alquiler -34.53344 -58.49345 2020    06
## 6            PH       Alquiler -34.66253 -58.52914 2020    06</code></pre>
<p>Otra aplicación que tiene <code>mutate()</code> es la de agregar columnas con algun contenido que elijamos nosotros, como por ejemplo sumemos una nueva columna que indique la fuente de donde descargamos toda esta información:</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="manipulación-de-datos.html#cb67-1" aria-hidden="true" tabindex="-1"></a>modificar <span class="ot">&lt;-</span> <span class="fu">mutate</span>(datos_amba, <span class="at">fuente=</span><span class="st">&quot;Properati&quot;</span>)</span>
<span id="cb67-2"><a href="manipulación-de-datos.html#cb67-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-3"><a href="manipulación-de-datos.html#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(modificar)</span></code></pre></div>
<pre><code>##   created_on provincia       partido rooms surface_total surface_covered price currency
## 1     202006      CABA      Comuna 7     1            40              37 22500      ARS
## 2     202006      CABA     Comuna 13     1            30              30 18000      ARS
## 3     202006      CABA     Comuna 13     1            31              29 17900      ARS
## 4     202006      CABA      Comuna 1     1            35              35 42000      ARS
## 5     202006       GBA Vicente López     1            36              27 19000      ARS
## 6     202006       GBA    La Matanza     2            24              24 12000      ARS
##                                                                           title
## 1                                                         Departamento - Flores
## 2                         Retasado! Monoambiente en Nuñez, excelente ubicación!
## 3                                                       Departamento - Belgrano
## 4                              Monoambiente con cochera. Zencity. Puerto Madero
## 5 Alquiler TORRE dpto de 1o2 ambientes - excelente luz y vista cochera optativa
## 6                                                        PH - Lomas Del Mirador
##   property_type operation_type       lat       lon    fuente
## 1  Departamento       Alquiler -34.61917 -58.46222 Properati
## 2  Departamento       Alquiler -34.55460 -58.46652 Properati
## 3  Departamento       Alquiler -34.56318 -58.46461 Properati
## 4  Departamento       Alquiler -34.61836 -58.36090 Properati
## 5  Departamento       Alquiler -34.53344 -58.49345 Properati
## 6            PH       Alquiler -34.66253 -58.52914 Properati</code></pre>
<p>Ahora veamos como modificar el tipo de dato dentro de una columna:</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="manipulación-de-datos.html#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(datos_amba<span class="sc">$</span>title)</span></code></pre></div>
<pre><code>## [1] &quot;factor&quot;</code></pre>
<p>Vemos que la variable “title” es de tipo factor, así que cambiemos su formato a character:</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="manipulación-de-datos.html#cb71-1" aria-hidden="true" tabindex="-1"></a>modificar <span class="ot">&lt;-</span> <span class="fu">mutate</span>(datos_amba, <span class="at">title=</span><span class="fu">as.character</span>(title))</span>
<span id="cb71-2"><a href="manipulación-de-datos.html#cb71-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-3"><a href="manipulación-de-datos.html#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(modificar<span class="sc">$</span>title)</span></code></pre></div>
<pre><code>## [1] &quot;character&quot;</code></pre>
<p>En el ejemplo anterior utilizamos <code>as.character()</code> pero si quisiesemos convertir una variable a factor utilizariamos <code>as.factor()</code>, a numérica <code>as.numeric()</code> o a número entero <code>as.integer()</code>,</p>
<p>Por último, veamos como unir 2 columnas de texto en una con <code>paste()</code>:</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="manipulación-de-datos.html#cb73-1" aria-hidden="true" tabindex="-1"></a>modificar <span class="ot">&lt;-</span> <span class="fu">mutate</span>(datos_amba, <span class="at">prov_partido=</span><span class="fu">paste</span>(provincia, partido, <span class="at">sep=</span><span class="st">&quot;_&quot;</span>))</span>
<span id="cb73-2"><a href="manipulación-de-datos.html#cb73-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-3"><a href="manipulación-de-datos.html#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(modificar)</span></code></pre></div>
<pre><code>##   created_on provincia       partido rooms surface_total surface_covered price currency
## 1     202006      CABA      Comuna 7     1            40              37 22500      ARS
## 2     202006      CABA     Comuna 13     1            30              30 18000      ARS
## 3     202006      CABA     Comuna 13     1            31              29 17900      ARS
## 4     202006      CABA      Comuna 1     1            35              35 42000      ARS
## 5     202006       GBA Vicente López     1            36              27 19000      ARS
## 6     202006       GBA    La Matanza     2            24              24 12000      ARS
##                                                                           title
## 1                                                         Departamento - Flores
## 2                         Retasado! Monoambiente en Nuñez, excelente ubicación!
## 3                                                       Departamento - Belgrano
## 4                              Monoambiente con cochera. Zencity. Puerto Madero
## 5 Alquiler TORRE dpto de 1o2 ambientes - excelente luz y vista cochera optativa
## 6                                                        PH - Lomas Del Mirador
##   property_type operation_type       lat       lon      prov_partido
## 1  Departamento       Alquiler -34.61917 -58.46222     CABA_Comuna 7
## 2  Departamento       Alquiler -34.55460 -58.46652    CABA_Comuna 13
## 3  Departamento       Alquiler -34.56318 -58.46461    CABA_Comuna 13
## 4  Departamento       Alquiler -34.61836 -58.36090     CABA_Comuna 1
## 5  Departamento       Alquiler -34.53344 -58.49345 GBA_Vicente López
## 6            PH       Alquiler -34.66253 -58.52914    GBA_La Matanza</code></pre>
</div>
<div id="ordenar-registros" class="section level2" number="2.4">
<h2><span class="header-section-number">2.4</span> Ordenar registros</h2>
<p>Esta función nos permitirá ordenar las columnas en orden ascendente o descendente como se ve a continuación:</p>
<p><img src="images/tidyverse_ordenar.jpg" /></p>
<p>Probemos ordenar las filas de nuestro data frame en función de los valores de una o más columnas. Por defecto se ordena en forma ascendente:</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="manipulación-de-datos.html#cb75-1" aria-hidden="true" tabindex="-1"></a>ordenar <span class="ot">&lt;-</span> <span class="fu">arrange</span>(datos_amba, surface_total)</span>
<span id="cb75-2"><a href="manipulación-de-datos.html#cb75-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-3"><a href="manipulación-de-datos.html#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ordenar)</span></code></pre></div>
<pre><code>##   created_on provincia   partido rooms surface_total surface_covered price currency
## 1     202007      CABA Comuna 15     1            10              10 25000      USD
## 2     202006       GBA     Tigre     2            12              12 10500      ARS
## 3     202007      CABA  Comuna 1     1            14              14 35000      USD
## 4     202006      CABA  Comuna 2     1            15              15 12900      ARS
## 5     202007      CABA Comuna 15     1            18              18 48000      USD
## 6     202006       GBA     Morón     1            18              17 35000      USD
##                                                                      title property_type
## 1                             Garage - Cochera Descubierta en Villa Crespo  Departamento
## 2                    Departamento de 2 ambientes en Pradera, Santa Barbara  Departamento
## 3                                   VENTA PH 13,84 M2 PANTA BAJA BALVANERA            PH
## 4                                 Departamento en Alquiler en Barrio Norte  Departamento
## 5                       Venta Monoambiente estudio con amenities Chacarita  Departamento
## 6 Lindo monoambiente en 2do piso por escalera al frente. BAJAS EXPENSAS!!!  Departamento
##   operation_type       lat       lon
## 1          Venta -34.60330 -58.45547
## 2       Alquiler -34.44604 -58.63236
## 3          Venta -34.61566 -58.39221
## 4       Alquiler -34.59092 -58.40632
## 5          Venta -34.59043 -58.44666
## 6          Venta -34.64390 -58.63221</code></pre>
<p>Pero si queremos ordenar en forma descendente debemos aclararlo con <code>desc()</code>:</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="manipulación-de-datos.html#cb77-1" aria-hidden="true" tabindex="-1"></a>ordenar <span class="ot">&lt;-</span> <span class="fu">arrange</span>(datos_amba, <span class="fu">desc</span>(surface_total))</span>
<span id="cb77-2"><a href="manipulación-de-datos.html#cb77-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-3"><a href="manipulación-de-datos.html#cb77-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ordenar)</span></code></pre></div>
<pre><code>##   created_on provincia     partido rooms surface_total surface_covered  price currency
## 1     202007       GBA       Pilar     5          5000             300 120000      USD
## 2     202006       GBA San Vicente     3          4356             150  85000      USD
## 3     202007       GBA       Pilar     6          3780             320 220000      USD
## 4     202006      CABA   Comuna 13     2          3650              35 109500      USD
## 5     202007       GBA       Luján     4          2703             182 370000      USD
## 6     202007       GBA       Pilar     3          2500              70 121000      USD
##                                                           title property_type
## 1                                          Venta de Casa Quinta          Casa
## 2 España entre Buchard y Esmeralda. Casa en venta, San Viciente          Casa
## 3            Venta casaquinta Del Viso Residencial Los Jazmines          Casa
## 4            Acogedor Departamento de dos ambientes en Belgrano  Departamento
## 5                Casa 3 dormitorios estilo campo Estancias Golf          Casa
## 6              VENTA CASA 2 AMBIENTES PILAR 2500 M2 DE PARQUE!!          Casa
##   operation_type       lat       lon
## 1          Venta -34.40066 -58.86919
## 2          Venta -35.02984 -58.40594
## 3          Venta -34.45687 -58.79651
## 4          Venta -34.55398 -58.44853
## 5          Venta -34.49543 -59.00930
## 6          Venta -34.41586 -58.85729</code></pre>
<p>También podemos ordenar por 2 o más columnas. En este caso, R priorizará ordenar la primera, luego la segunda, y asi sucesivamente. Veamos un ejemplo:</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="manipulación-de-datos.html#cb79-1" aria-hidden="true" tabindex="-1"></a>ordenar <span class="ot">&lt;-</span> <span class="fu">arrange</span>(datos_amba, partido, rooms)</span>
<span id="cb79-2"><a href="manipulación-de-datos.html#cb79-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-3"><a href="manipulación-de-datos.html#cb79-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ordenar)</span></code></pre></div>
<pre><code>##   created_on provincia         partido rooms surface_total surface_covered  price currency
## 1     202006       GBA Almirante Brown     2            40              40  14500      ARS
## 2     202006       GBA Almirante Brown     2            60              60  20000      ARS
## 3     202006       GBA Almirante Brown     2            50              50 125000      USD
## 4     202007       GBA Almirante Brown     2            52              48  18000      ARS
## 5     202007       GBA Almirante Brown     2            47              47  16000      ARS
## 6     202007       GBA Almirante Brown     2            50              50  96000      USD
##                                                                                      title
## 1                                                                 Departamento en alquiler
## 2                                                                   Departamento - Adrogue
## 3                                                                   Departamento - Adrogue
## 4 Venta de Departamento 2 ambientes en Hermoso Edificio a metros de Plaza Brown de Adrogué
## 5                                             DEPARTAMENTO 2 AMBIENTES EN AV ESPORA AL 800
## 6                                                                   Departamento - Adrogue
##   property_type operation_type       lat       lon
## 1  Departamento       Alquiler -34.81144 -58.39264
## 2  Departamento       Alquiler -34.79964 -58.38278
## 3  Departamento          Venta -34.79732 -58.39132
## 4  Departamento       Alquiler -34.79720 -58.38280
## 5  Departamento       Alquiler -34.79880 -58.38863
## 6  Departamento          Venta -34.79913 -58.38364</code></pre>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="manipulación-de-datos.html#cb81-1" aria-hidden="true" tabindex="-1"></a>ordenar <span class="ot">&lt;-</span> <span class="fu">arrange</span>(datos_amba, partido, <span class="fu">desc</span>(rooms))</span>
<span id="cb81-2"><a href="manipulación-de-datos.html#cb81-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-3"><a href="manipulación-de-datos.html#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ordenar)</span></code></pre></div>
<pre><code>##   created_on provincia         partido rooms surface_total surface_covered   price
## 1     202007       GBA Almirante Brown     8           447             189  230000
## 2     202006       GBA Almirante Brown     7           670             590 1500000
## 3     202006       GBA Almirante Brown     5           239             112  169000
## 4     202006       GBA Almirante Brown     5           260             120  248000
## 5     202007       GBA Almirante Brown     5           370             220  230000
## 6     202006       GBA Almirante Brown     5           180             180  390000
##   currency
## 1      USD
## 2      USD
## 3      USD
## 4      USD
## 5      USD
## 6      USD
##                                                                                        title
## 1                                         Casa c/2 dptos, local y galpón - Lomas del Mirador
## 2                                                                             Casa - Adrogue
## 3 A REFACCIONAR! Casona colonial con gran lote, fondo libre, parrilla, 3 dormitorios 2 baños
## 4                                         Hermoso Duplex 3 dormitorios gran patio 4 cocheras
## 5                                            Chalet en venta Barrio Santa Rita -  Longchamps
## 6                        Casa en Construccion en Venta en Barrio Privado &#39;Brisas de Adrogue&#39;
##   property_type operation_type       lat       lon
## 1          Casa          Venta -34.86568 -58.37823
## 2          Casa          Venta -34.80905 -58.40631
## 3            PH          Venta -34.79638 -58.38691
## 4          Casa          Venta -34.79746 -58.37885
## 5          Casa          Venta -34.86473 -58.39129
## 6          Casa          Venta -34.81368 -58.40300</code></pre>
</div>
<div id="renombrar-columnas" class="section level2" number="2.5">
<h2><span class="header-section-number">2.5</span> Renombrar columnas</h2>
<p>Ahora veamos como cambiar los nombres a una o más columnas existentes en nuestro dataset:</p>
<p><img src="images/tidyverse_renombrar.jpg" /></p>
<p>Empecemos cambiando el nombre de la variable “rooms” por “ambientes”:</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="manipulación-de-datos.html#cb83-1" aria-hidden="true" tabindex="-1"></a>renombrar <span class="ot">&lt;-</span> <span class="fu">rename</span>(datos_amba, <span class="at">ambientes=</span>rooms)</span>
<span id="cb83-2"><a href="manipulación-de-datos.html#cb83-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3"><a href="manipulación-de-datos.html#cb83-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(renombrar)</span></code></pre></div>
<pre><code>##   created_on provincia       partido ambientes surface_total surface_covered price
## 1     202006      CABA      Comuna 7         1            40              37 22500
## 2     202006      CABA     Comuna 13         1            30              30 18000
## 3     202006      CABA     Comuna 13         1            31              29 17900
## 4     202006      CABA      Comuna 1         1            35              35 42000
## 5     202006       GBA Vicente López         1            36              27 19000
## 6     202006       GBA    La Matanza         2            24              24 12000
##   currency                                                                         title
## 1      ARS                                                         Departamento - Flores
## 2      ARS                         Retasado! Monoambiente en Nuñez, excelente ubicación!
## 3      ARS                                                       Departamento - Belgrano
## 4      ARS                              Monoambiente con cochera. Zencity. Puerto Madero
## 5      ARS Alquiler TORRE dpto de 1o2 ambientes - excelente luz y vista cochera optativa
## 6      ARS                                                        PH - Lomas Del Mirador
##   property_type operation_type       lat       lon
## 1  Departamento       Alquiler -34.61917 -58.46222
## 2  Departamento       Alquiler -34.55460 -58.46652
## 3  Departamento       Alquiler -34.56318 -58.46461
## 4  Departamento       Alquiler -34.61836 -58.36090
## 5  Departamento       Alquiler -34.53344 -58.49345
## 6            PH       Alquiler -34.66253 -58.52914</code></pre>
<p>Como habrán notado, primero hay que poner el nombre de la nueva columna y luego el de la columna actual. Esto es muy importante, porque si lo hacemos al revés nos dará un error.</p>
<p>Ahora veamos un ejemplo y cambiemos los nombres de 3 columnas:</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="manipulación-de-datos.html#cb85-1" aria-hidden="true" tabindex="-1"></a>renombrar <span class="ot">&lt;-</span> <span class="fu">rename</span>(datos_amba, <span class="at">ambientes=</span>rooms, <span class="at">m2_cubierto=</span>surface_covered, <span class="at">m2_total=</span>surface_total)</span>
<span id="cb85-2"><a href="manipulación-de-datos.html#cb85-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-3"><a href="manipulación-de-datos.html#cb85-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(renombrar)</span></code></pre></div>
<pre><code>##   created_on provincia       partido ambientes m2_total m2_cubierto price currency
## 1     202006      CABA      Comuna 7         1       40          37 22500      ARS
## 2     202006      CABA     Comuna 13         1       30          30 18000      ARS
## 3     202006      CABA     Comuna 13         1       31          29 17900      ARS
## 4     202006      CABA      Comuna 1         1       35          35 42000      ARS
## 5     202006       GBA Vicente López         1       36          27 19000      ARS
## 6     202006       GBA    La Matanza         2       24          24 12000      ARS
##                                                                           title
## 1                                                         Departamento - Flores
## 2                         Retasado! Monoambiente en Nuñez, excelente ubicación!
## 3                                                       Departamento - Belgrano
## 4                              Monoambiente con cochera. Zencity. Puerto Madero
## 5 Alquiler TORRE dpto de 1o2 ambientes - excelente luz y vista cochera optativa
## 6                                                        PH - Lomas Del Mirador
##   property_type operation_type       lat       lon
## 1  Departamento       Alquiler -34.61917 -58.46222
## 2  Departamento       Alquiler -34.55460 -58.46652
## 3  Departamento       Alquiler -34.56318 -58.46461
## 4  Departamento       Alquiler -34.61836 -58.36090
## 5  Departamento       Alquiler -34.53344 -58.49345
## 6            PH       Alquiler -34.66253 -58.52914</code></pre>
</div>
<div id="resumir-y-agrupar-datos" class="section level2" number="2.6">
<h2><span class="header-section-number">2.6</span> Resumir y agrupar datos</h2>
<p>Esta función es súper útil cuando manipulamos datos ya que nos permitirá realizar resumenes/sumarios de la data completa, obteniendo por ejemplo valores promedio, máximos o mínimos de una o más columnas.</p>
<p><img src="images/tidyverse_agrupar.jpg" /></p>
<p>Probemos calculando la mediana de todos los valores que aparecen en la columna surface_covered:</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="manipulación-de-datos.html#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summarise</span>(datos_amba, <span class="at">surface_covered=</span><span class="fu">median</span>(surface_covered))</span></code></pre></div>
<pre><code>##   surface_covered
## 1              66</code></pre>
<p>O calculemos un promedio de toda la columna surface_total:</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="manipulación-de-datos.html#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summarise</span>(datos_amba, <span class="at">surface_covered=</span><span class="fu">mean</span>(surface_covered))</span></code></pre></div>
<pre><code>##   surface_covered
## 1        91.98151</code></pre>
<p>También podemos averiguar el valor máximo o mínimo de alguna variable:</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="manipulación-de-datos.html#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summarise</span>(datos_amba, <span class="at">surface_covered=</span><span class="fu">max</span>(rooms))</span></code></pre></div>
<pre><code>##   surface_covered
## 1              10</code></pre>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="manipulación-de-datos.html#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summarise</span>(datos_amba, <span class="at">surface_covered=</span><span class="fu">min</span>(rooms))</span></code></pre></div>
<pre><code>##   surface_covered
## 1               1</code></pre>
<p>Como verán, esta función resulta útil para ver valores agregados de toda la base, sin embargo, también podemos agrupar los datos previo a calular los resumenes, y así obtener resumenes por agrupaciones en vez de uno solo para toda la base. Para esto vamos a utilizar <code>summarise()</code> junto a <code>group_by()</code>. Veamos un ejemplo:</p>
<ul>
<li><p>Primero agrupemos los datos por la variable “operation_type”.</p></li>
<li><p>Luego calculemos el promedio de superficie cubierta sobre la agrupación realizada previamente.</p></li>
</ul>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="manipulación-de-datos.html#cb95-1" aria-hidden="true" tabindex="-1"></a>agrupar <span class="ot">&lt;-</span> <span class="fu">group_by</span>(datos_amba, operation_type)</span>
<span id="cb95-2"><a href="manipulación-de-datos.html#cb95-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-3"><a href="manipulación-de-datos.html#cb95-3" aria-hidden="true" tabindex="-1"></a>resumir <span class="ot">&lt;-</span> <span class="fu">summarise</span>(agrupar, <span class="at">surface_covered=</span><span class="fu">mean</span>(surface_covered))</span>
<span id="cb95-4"><a href="manipulación-de-datos.html#cb95-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-5"><a href="manipulación-de-datos.html#cb95-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(resumir)</span></code></pre></div>
<pre><code>## # A tibble: 2 x 2
##   operation_type surface_covered
##   &lt;fct&gt;                    &lt;dbl&gt;
## 1 Alquiler                  72.9
## 2 Venta                     97.3</code></pre>
<p>Con la agrupación y el resumen podemos ver que la superficie cubierta promedio de las propiedades en alquiler es 72,93m2 y la de las propiedades en venta es 97,28m2.</p>
<p>Probemos agrupando por 3 columnas:</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="manipulación-de-datos.html#cb97-1" aria-hidden="true" tabindex="-1"></a>agrupar <span class="ot">&lt;-</span> <span class="fu">group_by</span>(datos_amba, operation_type, currency)</span>
<span id="cb97-2"><a href="manipulación-de-datos.html#cb97-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-3"><a href="manipulación-de-datos.html#cb97-3" aria-hidden="true" tabindex="-1"></a>resumir <span class="ot">&lt;-</span> <span class="fu">summarise</span>(agrupar, <span class="at">price_m2=</span><span class="fu">mean</span>(price<span class="sc">/</span>surface_covered))</span>
<span id="cb97-4"><a href="manipulación-de-datos.html#cb97-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-5"><a href="manipulación-de-datos.html#cb97-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(resumir)</span></code></pre></div>
<pre><code>## # A tibble: 2 x 3
## # Groups:   operation_type [2]
##   operation_type currency price_m2
##   &lt;fct&gt;          &lt;fct&gt;       &lt;dbl&gt;
## 1 Alquiler       ARS          520.
## 2 Venta          USD         2689.</code></pre>
<p>El valor del m2 promedio para las propiedades en Alquiler es de 520 $ARS mientras que para las propiedaes en venta es de 2.689 USD. Sin embargo, está claro que en el valor de CABA y GBA es diferente, así que calculemos el valor del m2 promedio para cada uno:</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="manipulación-de-datos.html#cb99-1" aria-hidden="true" tabindex="-1"></a>agrupar <span class="ot">&lt;-</span> <span class="fu">group_by</span>(datos_amba, operation_type, currency, provincia)</span>
<span id="cb99-2"><a href="manipulación-de-datos.html#cb99-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-3"><a href="manipulación-de-datos.html#cb99-3" aria-hidden="true" tabindex="-1"></a>resumir <span class="ot">&lt;-</span> <span class="fu">summarise</span>(agrupar, <span class="at">rooms=</span><span class="fu">mean</span>(price<span class="sc">/</span>surface_covered))</span>
<span id="cb99-4"><a href="manipulación-de-datos.html#cb99-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-5"><a href="manipulación-de-datos.html#cb99-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(resumir)</span></code></pre></div>
<pre><code>## # A tibble: 4 x 4
## # Groups:   operation_type, currency [2]
##   operation_type currency provincia rooms
##   &lt;fct&gt;          &lt;fct&gt;    &lt;fct&gt;     &lt;dbl&gt;
## 1 Alquiler       ARS      CABA       617.
## 2 Alquiler       ARS      GBA        399.
## 3 Venta          USD      CABA      3119.
## 4 Venta          USD      GBA       2024.</code></pre>
<p>Se ve claramente que hay una diferencia entre CABA y GBA, siendo CABA más caro para ambos tipos de operación. Por último probemos desagregando esta información por partido:</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="manipulación-de-datos.html#cb101-1" aria-hidden="true" tabindex="-1"></a>agrupar <span class="ot">&lt;-</span> <span class="fu">group_by</span>(datos_amba, operation_type, currency, partido)</span>
<span id="cb101-2"><a href="manipulación-de-datos.html#cb101-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-3"><a href="manipulación-de-datos.html#cb101-3" aria-hidden="true" tabindex="-1"></a>resumir <span class="ot">&lt;-</span> <span class="fu">summarise</span>(agrupar, <span class="at">price_m2=</span><span class="fu">mean</span>(price<span class="sc">/</span>surface_covered))</span>
<span id="cb101-4"><a href="manipulación-de-datos.html#cb101-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-5"><a href="manipulación-de-datos.html#cb101-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(resumir)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 4
## # Groups:   operation_type, currency [1]
##   operation_type currency partido         price_m2
##   &lt;fct&gt;          &lt;fct&gt;    &lt;fct&gt;              &lt;dbl&gt;
## 1 Alquiler       ARS      Almirante Brown     304.
## 2 Alquiler       ARS      Avellaneda          299.
## 3 Alquiler       ARS      Berazategui         311.
## 4 Alquiler       ARS      Comuna 1            699.
## 5 Alquiler       ARS      Comuna 10           381.
## 6 Alquiler       ARS      Comuna 11           444.</code></pre>
</div>
<div id="concatenar-funciones" class="section level2" number="2.7">
<h2><span class="header-section-number">2.7</span> Concatenar funciones (%&gt;%)</h2>
<p>Llegamos al final de la clase, ya vimos varias funciones por separado, pero ¿Qué pasa si queremos aplicarlas todas a la vez? ¿Cómo podemos hacerlo?</p>
<p>En este caso debemos usar el operador pipe (%&gt;%) <strong>Ctrl+Shift+M</strong> que sirve para encadenar funciones, y en vez de realizar una por una, poder realizar todas juntas.</p>
<p>Veamos algunos ejemplos:</p>
<p>Imaginemos que queremos calcular por mes y para cada provincia (CABA y GBA) cuantas propiedades hubo en venta, con que valor total promedio, con que valor del m2 promedio y con que superficie promedio. Así lo tenemos que hacer según lo aprendido hasta ahora:</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="manipulación-de-datos.html#cb103-1" aria-hidden="true" tabindex="-1"></a>concatenar <span class="ot">&lt;-</span> <span class="fu">filter</span>(datos_amba, operation_type<span class="sc">==</span><span class="st">&quot;Venta&quot;</span>)</span>
<span id="cb103-2"><a href="manipulación-de-datos.html#cb103-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-3"><a href="manipulación-de-datos.html#cb103-3" aria-hidden="true" tabindex="-1"></a>concatenar <span class="ot">&lt;-</span> <span class="fu">select</span>(concatenar, created_on, provincia, surface_covered, price)</span>
<span id="cb103-4"><a href="manipulación-de-datos.html#cb103-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-5"><a href="manipulación-de-datos.html#cb103-5" aria-hidden="true" tabindex="-1"></a>concatenar <span class="ot">&lt;-</span> <span class="fu">group_by</span>(concatenar, created_on, provincia)</span>
<span id="cb103-6"><a href="manipulación-de-datos.html#cb103-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-7"><a href="manipulación-de-datos.html#cb103-7" aria-hidden="true" tabindex="-1"></a>concatenar <span class="ot">&lt;-</span> <span class="fu">summarise</span>(concatenar, <span class="at">cantidad=</span><span class="fu">n</span>(),</span>
<span id="cb103-8"><a href="manipulación-de-datos.html#cb103-8" aria-hidden="true" tabindex="-1"></a>                        <span class="at">price=</span><span class="fu">mean</span>(price),</span>
<span id="cb103-9"><a href="manipulación-de-datos.html#cb103-9" aria-hidden="true" tabindex="-1"></a>                        <span class="at">surface_covered=</span><span class="fu">mean</span>(surface_covered),</span>
<span id="cb103-10"><a href="manipulación-de-datos.html#cb103-10" aria-hidden="true" tabindex="-1"></a>                        <span class="at">price_m2=</span>price<span class="sc">/</span>surface_covered)</span>
<span id="cb103-11"><a href="manipulación-de-datos.html#cb103-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-12"><a href="manipulación-de-datos.html#cb103-12" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(concatenar)</span></code></pre></div>
<pre><code>## # A tibble: 4 x 6
## # Groups:   created_on [2]
##   created_on provincia cantidad   price surface_covered price_m2
##        &lt;int&gt; &lt;fct&gt;        &lt;int&gt;   &lt;dbl&gt;           &lt;dbl&gt;    &lt;dbl&gt;
## 1     202006 CABA          3986 291547.            85.3    3420.
## 2     202006 GBA           2772 231074.           121.     1903.
## 3     202007 CABA          3110 251563.            80.5    3124.
## 4     202007 GBA           1810 206180.           116.     1783.</code></pre>
<p>Y así lo deberíamos hacer con pipe %&gt;%:</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="manipulación-de-datos.html#cb105-1" aria-hidden="true" tabindex="-1"></a>concatenar <span class="ot">&lt;-</span> datos_amba <span class="sc">%&gt;%</span></span>
<span id="cb105-2"><a href="manipulación-de-datos.html#cb105-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(operation_type<span class="sc">==</span><span class="st">&quot;Venta&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb105-3"><a href="manipulación-de-datos.html#cb105-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(created_on, provincia, surface_covered, price) <span class="sc">%&gt;%</span></span>
<span id="cb105-4"><a href="manipulación-de-datos.html#cb105-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(created_on, provincia) <span class="sc">%&gt;%</span></span>
<span id="cb105-5"><a href="manipulación-de-datos.html#cb105-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">cantidad=</span><span class="fu">n</span>(),</span>
<span id="cb105-6"><a href="manipulación-de-datos.html#cb105-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">price=</span><span class="fu">mean</span>(price),</span>
<span id="cb105-7"><a href="manipulación-de-datos.html#cb105-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">surface_covered=</span><span class="fu">mean</span>(surface_covered),</span>
<span id="cb105-8"><a href="manipulación-de-datos.html#cb105-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">price_m2=</span>price<span class="sc">/</span>surface_covered)</span>
<span id="cb105-9"><a href="manipulación-de-datos.html#cb105-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-10"><a href="manipulación-de-datos.html#cb105-10" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(concatenar)</span></code></pre></div>
<pre><code>## # A tibble: 4 x 6
## # Groups:   created_on [2]
##   created_on provincia cantidad   price surface_covered price_m2
##        &lt;int&gt; &lt;fct&gt;        &lt;int&gt;   &lt;dbl&gt;           &lt;dbl&gt;    &lt;dbl&gt;
## 1     202006 CABA          3986 291547.            85.3    3420.
## 2     202006 GBA           2772 231074.           121.     1903.
## 3     202007 CABA          3110 251563.            80.5    3124.
## 4     202007 GBA           1810 206180.           116.     1783.</code></pre>
<p>A partir de la agrupación y resumen por ejemplo podemos ver que:</p>
<ul>
<li>En ambos meses, en CABA hubo mayor cantidad de propiedades en venta.</li>
<li>En ambos meses, la superficie cubierta de las propiedades en venta en GBA son mayores que las de CABA.</li>
<li>En ambos meses el valor promedio del m2 es más alto en CABA que ne GBA.</li>
<li>En ambas zonas (CABA y GBA), entre Junio y Julio 2020 hubo una caída en la cantidad de propiedades publicadas y en el valor promedio del m2.</li>
</ul>
<p>Como verán, en ambos casos llegamos al mismo resultado, pero sin dudas, la segunda opción es la recomendable porque nos ahorramos varias líneas de código y resultados intermedios.</p>
</div>
<div id="transformar-la-estructura-de-los-datos" class="section level2" number="2.8">
<h2><span class="header-section-number">2.8</span> Transformar la estructura de los datos</h2>
<p>El paquete <code>tidyverse</code> también nos permite realizar transformaciones en la estructura de nuestro dataset. Pero, ¿A qué nos referimos con esto? A continuación analizaremos 2 casos:</p>
<p>Tipo 1. Nuestro dataset tiene <strong>diferentes categorías</strong> que están <strong>separadas en muchas filas</strong>. Por ejemplo:</p>
<p><img src="images/opcion2.JPG" /></p>
<p>Tipo 2. Nuestro dataset tiene <strong>diferentes categorías</strong> que están <strong>separadas en muchas columnas</strong>. Por ejemplo:</p>
<p><img src="images/opcion1.JPG" />
<img src="images/opcion1.JPG" /></p>
<p>Como verán, en ambos casos la información es la misma, lo que cambia es la estructura.</p>
<p>Es muy probable que al analizar bases de datos nos encontramos con algunas estructuras similares a estas y querramos cambiarlas. Para pasar del Tipo 1 de estructura al Tipo 2 y viceversa utilizaremos las funciones <code>spread()</code> y <code>gather()</code> respectivamente.</p>
<p><img src="images/spread_gather.jpg" /></p>
<p>Sigamos utilizando nuestro dataset de Properati, pero para trabajar con menos volumen de datos y que sea más sencillo comprender el ejemplo, hagamos una agrupación por provincia y tipo de operación y calculemos el valor del m2:</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="manipulación-de-datos.html#cb107-1" aria-hidden="true" tabindex="-1"></a>transformar <span class="ot">&lt;-</span> datos_amba <span class="sc">%&gt;%</span></span>
<span id="cb107-2"><a href="manipulación-de-datos.html#cb107-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(provincia, operation_type) <span class="sc">%&gt;%</span></span>
<span id="cb107-3"><a href="manipulación-de-datos.html#cb107-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">valor_m2=</span><span class="fu">mean</span>(price<span class="sc">/</span>surface_covered))</span></code></pre></div>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="manipulación-de-datos.html#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(transformar)</span></code></pre></div>
<pre><code>## # A tibble: 4 x 3
## # Groups:   provincia [2]
##   provincia operation_type valor_m2
##   &lt;fct&gt;     &lt;fct&gt;             &lt;dbl&gt;
## 1 CABA      Alquiler           617.
## 2 CABA      Venta             3119.
## 3 GBA       Alquiler           399.
## 4 GBA       Venta             2024.</code></pre>
<p>Bien, ya tenemos un pequeño dataset de 3 columnas y 4 filas que presentan una estructura similar a la que se muestra al inicio como “Tipo 1”.</p>
<div id="extender-la-estructura-de-los-datos-spread" class="section level3" number="2.8.1">
<h3><span class="header-section-number">2.8.1</span> Extender la estructura de los datos: spread()</h3>
<p>Si necesitamos pasar el dataset al otro formato extendido, debemos usar <code>spread()</code> indicando el dataset que quiero modificar (datos_amba), la columna que quiero separar (key=operation_type) y la columna que contiene lo valores que quiero mantener en la tabla (value=valor_m2):</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="manipulación-de-datos.html#cb110-1" aria-hidden="true" tabindex="-1"></a>extender <span class="ot">&lt;-</span> <span class="fu">spread</span>(transformar, <span class="at">key=</span>operation_type, <span class="at">value=</span>valor_m2)</span></code></pre></div>
<p>El resultado es el siguiente:</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="manipulación-de-datos.html#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(extender)</span></code></pre></div>
<pre><code>## # A tibble: 2 x 3
## # Groups:   provincia [2]
##   provincia Alquiler Venta
##   &lt;fct&gt;        &lt;dbl&gt; &lt;dbl&gt;
## 1 CABA          617. 3119.
## 2 GBA           399. 2024.</code></pre>
<p>Se ve como ahora tenemos un dataset extendido, donde las categorías incluidas en columna operation_type se dividieron en 2 columnas: “Alquiler” y “Venta”. Pero, ¿Cómo hacemos si queremos volver al dataset original?</p>
<p>Esto lo hacemos con la función <code>gather()</code>.</p>
</div>
<div id="unificar-los-datos-gather" class="section level3" number="2.8.2">
<h3><span class="header-section-number">2.8.2</span> Unificar los datos: gather()</h3>
<p>Esta función que une múltiples columnas en una sola, se suele utilizar cuando todas las columnas representan valores de una variable. Por ejemplo, en nuestro caso, tanto “Alquiler” como “Venta” pueden ser categorías de una variable llamada operation_type.</p>
<p>Para utilizar <code>gather()</code> debemos indicar el dataset que queremos modificar (datos_amba), la nueva columna donde queremos agrupar múltiples columnas (key=“operation_type”), la nueva columna donde queremos agrupar los valores de toda la tabla (value=“valor_m2”), y por último debemos indicar que rango de columnas son las que queremos incluir en la key (Alquiler:Venta).</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="manipulación-de-datos.html#cb113-1" aria-hidden="true" tabindex="-1"></a>unificar <span class="ot">&lt;-</span> <span class="fu">gather</span>(extender, <span class="at">key=</span><span class="st">&quot;operation_type&quot;</span>, <span class="at">value=</span><span class="st">&quot;valor_m2&quot;</span>, Alquiler<span class="sc">:</span>Venta)</span></code></pre></div>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="manipulación-de-datos.html#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(unificar)</span></code></pre></div>
<pre><code>## # A tibble: 4 x 3
## # Groups:   provincia [2]
##   provincia operation_type valor_m2
##   &lt;fct&gt;     &lt;chr&gt;             &lt;dbl&gt;
## 1 CABA      Alquiler           617.
## 2 GBA       Alquiler           399.
## 3 CABA      Venta             3119.
## 4 GBA       Venta             2024.</code></pre>
<p>Y ahora si, volvimos al otro formato de tabla.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="presentaciÃ³n.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="análisis-y-visualización-de-datos.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["manual-big-data-urbana.pdf", "manual-big-data-urbana.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
